<!--<i>{{sessionMessageDataCopy|json}}</i>-->
<div class="card">
  <div class="card-header d-flex  justify-content-between align-items-center">
    <div class="d-flex ">
      <i class="fa fa-angle-left pr-2 cursor-pointer"
         [ngClass]="{invisible:indexOfCurrentRowSelected<=0 && pageNumberOfCurrentRowSelected<=1}"
         (click)="selectPrevRow.emit()"></i>
      <i class="fa fa-angle-right cursor-pointer"
         (click)="selectNextRow.emit()"></i>
    </div>
<!---->
    <div class="d-flex  align-items-center justify-content-center">
      <i class="fa fa-refresh mr-2 cursor-pointer" [ngClass]="{'fa-spin':showSpinIcon}"
         (click)="updateModal(_session.id);"></i>
      <div class="d-flex  flex-column align-items-start align-content-start">
        <span class="secondary">Last updated at</span>
        <span class="primary">{{_session.updated_at|date:'mediumDate'}}</span>
      </div>
    </div>

    <div class="d-flex  flex-column">
      <span class="secondary">Total Messages</span>
      <span class="primary16">{{sessionMessageData?.length}}</span>
    </div>

    <div class="d-flex  flex-column">
      <span class="secondary">Sent to agent</span>
      <span class="primary16">false</span>
    </div>

    <div class=" ">
      <div class="d-flex justify-content-center">
        <div class="secondary  font-weight-bold">Room ID:</div>
        <div class="secondary ">{{_session.id}}</div>
      </div>
      <!---->
      <div class="d-flex">
        <div class="secondary font-weight-bold">Consumer ID:</div>
        <div class="secondary">{{_session.consumer_id}}</div>
      </div>
    </div>

    <div (click)="closeModel$.emit()"><i class="fa fa-times cursor-pointer"></i></div>
    <!---->
  </div>
  <div class="card-body p-0" style="height: 80vh">
    <div class="row mx-0 p-0 py-2" style="height: 100%">

      <div class="col-6 pl-0 pr-0 pb-3 border-right">
        <!--search input starts-->
        <div class="container p-0">
          <div class="row py-2 border-bottom">
            <div class="col-8">
              <div class="input-group border p-1"
                   style="height: 32px;border-radius: 2px!important;position: relative">
                <input class="form-control py-2 border-0" [ngModel]="messageSearchKeyword"
                       (ngModelChange)="scrollToFirstKeywordMatch($event)"
                       (keyup.enter)="goToNextSearchResult(messageSearchKeyword)"
                       (keyup.shift.enter)="goToPreviousSearchResult(messageSearchKeyword)"
                       id="search-session-model" type="search"
                       placeholder="search">
                <!--<i class="fa fa-angle-down text-dark"-->
                <!--style="font-size: 18px;position: absolute; right: 10px;top: 6px; z-index: 10 "></i>-->
                <i class="fa fa-search"
                   style="font-size: 18px;position: absolute; left: 10px;top: 6px;color: #e0e0e0;z-index: 10"></i>
              </div>
            </div>
          </div>
          <!--search input ends-->
          <div class="session-messages-container row m-0 my-2 p-1 align-items-start align-content-start">
            <i class="fa" [ngClass]="{'fa-angle-down':scrollDown,'fa-angle-up':!scrollDown}" *ngIf="sessionMessageDataCopy && sessionMessageDataCopy.length >5" (click)="scrollMessageList()"></i>
            <div style="height: 100%;width: 100%; padding-right: 5px" class="session-messages-container-list">
              <div class="col-12 px-0 border-hover-txn"
                   style="padding-left: 5px !important;"
                   *ngFor="let txnConversationItems of sessionMessageDataCopy|serializeSessionMessage|highlightSessionTexts:messageSearchKeyword; let i=index"
                   [ngClass]="{'border-selected-txn':txnConversationItems.transaction_id === transactionIdSelectedInModel,
                        'border-unselected-txn':txnConversationItems.transaction_id !== transactionIdSelectedInModel}">
                <!--<app-chat-feedback></app-chat-feedback>-->
                <app-session-message [txnConversationItems]="txnConversationItems"
                                     (messageClickedEvent$)="transactionIdChangedInModel($event)"></app-session-message>
              </div>
            </div>
            <div *ngIf="!sessionMessageDataCopy || sessionMessageData.length===0"
                 style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; "
                 class="col-12 align-self-stretch d-flex justify-content-center align-items-center">
              <p class="text-muted">No Messages to show</p>
            </div>
          </div>
        </div>
      </div>
      <!--</div>-->
      <div class="col-6 d-flex flex-column">
        <ul class="nav nav-tabs my-2 pb-0">
          <!--TODO: *ngIf="bot.child_bots && bot.child_bots.length>0" below-->
          <li class="nav-item px-0">
            <a class="nav-link p-0 mr-2" [ngClass]="{'tab-active':activeTab==='manager_bot'}"
               (click)="tabClicked('manager_bot')"><strong>TRANSACTION INFO</strong></a>
          </li>
          <li class="nav-item">
            <a class="nav-link p-0" [ngClass]="{'tab-active':activeTab==='active_bot'}"
               (click)="tabClicked('active_bot')" *ngIf="bot.is_manager"><strong>ACTIVE BOT</strong></a>
          </li>
          <li class="nav-item ml-auto">
            <a class="nav-link p-0 mr-2" [ngClass]="{'tab-active':activeTab==='final_df'}"
               (click)="tabClicked('final_df')"><strong>FINAL DF</strong></a>
          </li>
          <li class="nav-item">
            <a class="nav-link p-0" [ngClass]="{'tab-active':activeTab==='datastore'}"
               (click)="tabClicked('datastore')"><strong>DATASTORE</strong></a>
          </li>
        </ul>
        <pre *ngIf="codeText" class="p-2" style="width: 100%; height: 100%; background-color: #000055; color: white">
                {{(codeText|json)}}
              </pre>
        <div *ngIf="!codeText" class="p-2 d-flex flex-column justify-content-center align-items-center"
             style="width: 100%; height: 100%;">
          <i class="fa fa-arrow-left" style="font-size: 15px; color: #9e9e9e"></i>
          <i style="color: #9e9e9e;">Select a transaction to
            see metadata associated</i>
        </div>
      </div>
    </div>
  </div>
</div>
<!--</div>-->
<!--</div>-->
<!--</div>-->
