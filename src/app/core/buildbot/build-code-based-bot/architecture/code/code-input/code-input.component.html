<!--<p>{{selectedVersion|json}}</p>-->
<!--<button (click)="test()">==>{{selectedVersion.changed_fields['df_template']}} </button>-->

<div class="d-flex-column-last-child-flex-grow-1">
  <div class="row row-version my-2 m-0 child-no-expand-shrink " style="position: relative" (clickOutside)="showVersionList = false">
    <div class="col-6 p-0" [ngClass]="{'bg-theme-secondary':!selectedVersion}">
      <div *ngIf="selectedVersion" class="d-flex align-items-center flex-bot-versioning-toaster border-theme-secondary">
        <div class="version-active-label" *ngIf="selectedVersion" [ngClass]="{'bg-label-active':selectedVersion?.id === activeVersion?.id,'bg-label-inactive':selectedVersion?.id !== activeVersion?.id}">
          <div>{{selectedVersion.id === (activeVersion && activeVersion.id)?'Active':'Inactive'}}</div>
        </div>
        <!--<button *ngIf="selectedVersion?.id === activeVersion?.id" class="btn btn-theme-primary mr-1"-->
        <!--style="flex-basis: 56px">Active-->
        <!--</button>-->
        <!--<button-->
        <!--*ngIf="selectedVersion?.id !== activeVersion?.id" class="btn btn-theme-dark mr-1"-->
        <!--style="flex-basis: 56px">Inactive-->
        <!--</button>-->
        <div class="count mx-1 flex-shrink-0 flex-grow-0">{{selectedVersion.version}}</div>
        <div class="forked mr-1 pl-1" *ngIf="selectedVersion.forked_from !== 0">Forked from version
          {{selectedVersion.forked_from}}
        </div>
        <div class="forked mr-1 pl-1" *ngIf="selectedVersion.forked_from === 0">Default created version
        </div>
        <div class="update d-flex flex-column mr-1 justify-content-center">
          <div>Last update</div>
          <div class="d-flex justify-content-left pt-1" *ngIf="selectedVersion">
            <!-- <i class="fa fa-circle"
               [ngClass]="{'text-danger':selectedVersion.updated_fields['df_template'], 'dark-green':activeTab==='df_template'}"></i> -->
            <i class="fa fa-circle" [ngClass]="{'text-danger':selectedVersion.changed_fields['df_template'], 'dark-green':selectedVersion.updated_fields['df_template']}"></i>
            <i class="fa fa-circle" [ngClass]="{'text-danger':selectedVersion.changed_fields['df_rules'], 'dark-green':selectedVersion.updated_fields['df_rules']}"></i>
            <i class="fa fa-circle" [ngClass]="{'text-danger':selectedVersion.changed_fields['generation_rules'], 'dark-green':selectedVersion.updated_fields['generation_rules']}"></i>
            <i class="fa fa-circle" [ngClass]="{'text-danger':selectedVersion.changed_fields['generation_templates'], 'dark-green':selectedVersion.updated_fields['generation_templates']}"></i>
            <i class="fa fa-circle" [ngClass]="{'text-danger':selectedVersion.changed_fields['workflow'], 'dark-green':selectedVersion.updated_fields['workflow']}"></i>
          </div>
          <!--<form class="d-flex">-->
          <!--<input type="radio" name="optradio" checked>-->
          <!--<input type="radio" name="optradio">-->
          <!--<input type="radio" name="optradio">-->
          <!--<input type="radio" name="optradio">-->
          <!--<input type="radio" name="optradio">-->
          <!--</form>-->
        </div>
        <div class="insert mr-1" *ngIf="selectedVersion && selectedVersion.comment" [popover]="selectedVersion.comment"
          placement="bottom" triggers="mouseenter:mouseleave">
          {{selectedVersion.comment.length>70?(((selectedVersion.comment)|slice:0:100)
          +"..."):selectedVersion?.comment}}
          <!--<div class="insert mr-1">{{(selectedVersion.comment)|slice:0:100}}-->
        </div>
        <!---->
        <i (click)="showVersionList= !showVersionList" *ngIf="bot.store_bot_versions && bot.store_bot_versions.length > 1"
          class="fa py-2 px-3 bg-theme-primary text-white ml-auto cursor-pointer" [ngClass]="{'fa-angle-up':showVersionList, 'fa-angle-down':!showVersionList}"
          style="height: 100%"></i>
      </div>
    </div>
    <div class="col-6">
      <button [disabled]="!selectedVersion" class="btn btn-theme-primary-outline mr-1" *myIf="myEAllActions['Update Bot Versioning']"
        (click)="saveSelectedVersion()">
        {{(!bot.store_bot_versions || !bot.store_bot_versions.length ||
        bot.store_bot_versions.length>0)?"Save":"Create"}}
        version
      </button>
      <div *ngIf="selectedVersion" class="d-inline-block">
        <button class="btn btn-theme-primary-outline" [disabled]="!bot.store_bot_versions || bot.store_bot_versions.length===0"
          *myIf="myEAllActions['Create Bot Versioning']" (click)="openForkNewVersionModal(Primarytemplate)">
          Fork new version
        </button>
      </div>
    </div>
    <div class="row row-flex-bot-versioning-toaster border-theme-secondary  border-top-0 mx-0" *ngIf="showVersionList"
      style="max-height: 50vh; overflow-y: scroll">
      <div class="col-12 py-1 px-0 cursor-pointer hover-change-background border-bottom-theme-secondary" *ngFor="let version of bot.store_bot_versions | filterActiveBot:selectedVersion.id">
        <div class="d-flex align-items-center flex-bot-versioning-toaster" (click)="changeSelectedVersion(version); showVersionList = false; tabClicked('df_template');">

          <div class="version-active-label">
            <div>{{version.id === (activeVersion && activeVersion.id)?'Active':'Inactive'}}</div>
          </div>
          <!--<div class="active-label-text">{{version.id +""+activeVersion.id }}</div>-->
          <div class="count mr-1">{{version.version}}</div>
          <div class="forked mr-1 pl-1" *ngIf="version.forked_from !== 0">Forked from version
            {{version.forked_from}}
          </div>
          <div class="forked mr-1 pl-1" *ngIf="version.forked_from === 0">Default created version
          </div>

          <!--change dot start-->
          <div class="update d-flex flex-column mr-1 justify-content-center" *ngIf="version">
            <div class="mr-1">Last update</div>
            <div class="justify-content-left pt-1">
              <i class="fa fa-circle" [ngClass]="{'dark-green':version.updated_fields['df_template']}"></i>
              <i class="fa fa-circle" [ngClass]="{'dark-green':version.updated_fields['df_rules']}"></i>
              <i class="fa fa-circle" [ngClass]="{'dark-green':version.updated_fields['generation_rules']}"></i>
              <i class="fa fa-circle" [ngClass]="{'dark-green':version.updated_fields['generation_templates']}"></i>
              <i class="fa fa-circle" [ngClass]="{'dark-green':version.updated_fields['workflow']}"></i>
            </div>
          </div>
          <!--change dot end-->

          <div class="insert mr-1">{{version.comment.length>70?(((version.comment)|slice:0:100)
            +"..."):version?.comment}}
          </div>
          <i class=" py-2 px-3 "></i>
        </div>
      </div>
    </div>
  </div>

  <div class="row row-tabs child-no-expand-shrink ">
    <div class="col-12">
      <div class="card ">

        <!--tabs start-->
        <div class="card-body p-0 mr-0">
          <ul class="nav nav-tabs theme-tabbing">
            <li class="nav-item" [ngClass]="{'tab-active': activeTab===myEBotVersionTabs.df_template}">
              <a class="nav-link text-theme-normal" (click)="tabClicked(myEBotVersionTabs.df_template)">DF Template</a>
            </li>
            <li class="nav-item" [ngClass]="{'tab-active': activeTab===myEBotVersionTabs.df_rules}">
              <a class="nav-link text-theme-normal" (click)="tabClicked(myEBotVersionTabs.df_rules)">DF
                Rules</a>
            </li>
            <li class="nav-item text-theme-normal" [ngClass]="{'tab-active': activeTab===myEBotVersionTabs.generation_rules}">
              <a class="nav-link" (click)="tabClicked(myEBotVersionTabs.generation_rules)">Generation Rules</a>
            </li>
            <li class="nav-item text-theme-normal" [ngClass]="{'tab-active': activeTab===myEBotVersionTabs.generation_templates}">
              <a class="nav-link" (click)="tabClicked(myEBotVersionTabs.generation_templates)">Generation Template</a>
            </li>
            <li class="nav-item text-theme-normal" [ngClass]="{'tab-active': activeTab===myEBotVersionTabs.workflow}">
              <a class="nav-link" (click)="tabClicked(myEBotVersionTabs.workflow)">Workflows</a>
            </li>
            <li>
              <!--<button [hidden]="activeTab!==myEBotVersionTabs.generation_templates" (click)="showGenTempUi = !showGenTempUi; convertUiDictToGenTemplateCode()">button123-->
              <!--</button>-->
            <li class="ml-auto gen-templet-toggle d-flex align-items-center" *ngIf="activeTab===myEBotVersionTabs.generation_templates">
              <!-- <button [hidden]="activeTab!==myEBotVersionTabs.generation_templates" (click)="showGenTempUi = !showGenTempUi">button</button> -->
              <span>Interface</span>
              <ui-switch (change)="genTemplateViewChange($event)" color="rgb(0, 34, 64)" switchColor="white" name="toggle_gen_templet"
                [(ngModel)]="showGenTempEditorAndHideGenTempUi" class="d-flex align-items-center mx-1 " style="border:none;padding: 0;"
                size="small" title="Toggle UI view"></ui-switch>
              <span>Code</span>

            </li>
          </ul>
          <!--tabs end-->

        </div>
      </div>
    </div>
  </div>
  <!-- code editor starts here -->
  <div class="d-flex" style="height:100%">
    <div class="code-editor-row code-editor-row-max position-relative child-expand  d-flex-column-last-child-flex-grow-1">

      <app-code-editor class="child-expand" [hidden]="activeTab!==myEBotVersionTabs.df_template" [text]="editorCodeObj[myEBotVersionTabs.df_template]"
        (textChangedEvent)="saveText($event)" (validateClick) = "validateCodeTest($event)"></app-code-editor>

      <app-code-editor [hidden]="activeTab!==myEBotVersionTabs.df_rules" [text]="editorCodeObj[myEBotVersionTabs.df_rules]"
        (textChangedEvent)="saveText($event)"  (validateClick) = "validateCodeTest($event)"></app-code-editor>

      <app-code-editor [hidden]="activeTab!==myEBotVersionTabs.generation_rules" [text]="editorCodeObj[myEBotVersionTabs.generation_rules]"
        (textChangedEvent)="saveText($event)" (validateClick) = "validateCodeTest($event)"></app-code-editor>

      <!--generation template UI starts-->
      <div class="row mx-0 pl-3 genTempGrid pt-2 child-expand" *ngIf="activeTab===myEBotVersionTabs.generation_templates && !showGenTempEditorAndHideGenTempUi">
        <!--left sidebar starts-->
        <div class="genTempGridItem intent-header ml-1 position-relative">
          <div style="position: absolute; top: 0; left: 0; right: 0; max-height: 100%; z-index: 10; overflow-y: auto; overflow-x: hidden">
            <div class="d-flex" style="align-items:center;">
              <div class="text-bold">Templates</div>
              <div class="ml-auto text-theme-primary pr-2 new-intent-btn cursor-pointer d-flex align-item-center" style="color: #00abd3;"
                (click)="openNewIntentModal(IntentModal)">
                <i class="fa fa-plus pr-1 my-auto"></i>Add New
              </div>
            </div>
            <input *ngIf="templateKeyDict && myObject.keys(templateKeyDict) && myObject.keys(templateKeyDict).length>0;"
              type="text" placeholder="Search Intent" [(ngModel)]="templateKeySearchKeyword">
            <div class="d-flex align-items-center show-on-hover" *ngFor="let tempKey of myObject.keys(templateKeyDict||{})|filterTemplateLeyList:templateKeySearchKeyword">
              <div class="pl-2 p-1 tab-theme" [ngClass]="{'font-weight-bold':selectedTemplateKeyInLeftSideBar === tempKey}"
                (click)="selectedTemplateKeyInLeftSideBar = tempKey;selectedTemplateKeyOutputIndex = [];">{{tempKey}}
              </div>
              <i class="fa fa-edit ml-auto mr-1 cursor-pointer hide-it" style="color: #9e9e9e" (click)="templateKeyToBeDeleted.value= tempKey; openEditTemplateKeyModal(EditTemplateKeyModal);"></i>
              <i class="fa fa-trash mx-2 cursor-pointer hide-it" style="color: #9e9e9e" (click)="templateKeyToBeDeleted.value= tempKey;openDeleteTemplateKeyModal(deleteTemplateKeyModal)"></i>
            </div>

          </div>

          <div *ngIf="!(templateKeyDict && myObject.keys(templateKeyDict) && myObject.keys(templateKeyDict).length>0)"
            class="d-flex align-items-center" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0;">
            <div class="align-self-center mx-2 text-center" style="color: #9e9e9e;">
              Add new template key to start adding responses
            </div>
          </div>
        </div>
        <!--left sidebar ends-->

        <div class="genTempGridItemGrid" style="position: relative">

          <div *ngIf="!(templateKeyDict && myObject.keys(templateKeyDict) && myObject.keys(templateKeyDict).length>0)"
            class="d-flex align-items-center justify-content-center mx-5 px-5" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0;">
            <div class="text-center d-flex flex-wrap justify-content-center mx-5 px-5" style="color: #9e9e9e;">
              <div class="bg-white d-flex justify-content-center align-items-center" style="height: 56px; width: 56px; border-radius: 28px">
                <!--<i class="fa fa-cloud" style="color: #00abd3"></i>-->
                <i class="fa fa-commenting" style="color: #00abd3; font-size: 25px"></i>
              </div>
              <div class="w-100">Start configuring responses by adding a new template key from the left panel</div>
            </div>
          </div>

          <div class="response-test px-2">
            Response Flow {{templateKeyDict && selectedTemplateKeyInLeftSideBar &&
            templateKeyDict[selectedTemplateKeyInLeftSideBar] &&
            ((templateKeyDict[selectedTemplateKeyInLeftSideBar]|dataType)!=='string') ?
            ('('+templateKeyDict[selectedTemplateKeyInLeftSideBar].length+')'):""}}
          </div>
          <div class="form-group m-0 channel-drop d-flex align-items-center">
            <label for="" class="px-2 my-0">Channel</label>
            <div class="position-relative" *ngIf="bot?.integrations?.channels && myObject.keys(bot.integrations.channels)?.length>0; else noChannelsMessageTemplate">
              <img style="position: absolute; width: 15px; height: 15px; top: 50%; transform: translate(5px, -50%)"
                [src]="(selectedChannelOfGenTemplate?.name|logosByIntegrationName)?.icon" alt="">
              <select id="gentemplate-channel-selector" [ngModel]="selectedChannelOfGenTemplate?.displayName"
                (ngModelChange)="selectedChannelChanged($event)" required name="platform">
                <option *ngFor="let channel of channelList" type="button" [value]="channel.name">{{channel.displayName}}
                </option>
              </select>
            </div>
            <ng-template #noChannelsMessageTemplate>
              <i class="text-danger" style="font-size: 11px">No Channels</i>
            </ng-template>
          </div>

          <!--if the value of template key is unpasable, we will show response components-->
          <!--response components list start-->
          <div class="intentItems position-relative ">
            <div #scrollMe style="position: absolute; top: 0; left: 0; right: 0; max-height: 100%; overflow-y: auto; overflow-x: hidden">
              <ng-container *ngIf="templateKeyDict && (templateKeyDict[selectedTemplateKeyInLeftSideBar]|dataType)!=='string'">
                <div class="py-1 px-0 mb-3" *ngFor="let outputItem of templateKeyDict[selectedTemplateKeyInLeftSideBar]|filterResponseComponentByChannelName:selectedChannelOfGenTemplate?.name; let i = index">
                  <app-text-gentemplate *ngIf="outputItem.text" [outputItem]="outputItem" [variants]="outputItem.text"
                    [myIndex]=i [totalResponseTemplateComponentCount]="myObject.keys(templateKeyDict[selectedTemplateKeyInLeftSideBar]).length"
                    [selectedTemplateKeyOutputIndex]="selectedTemplateKeyOutputIndex" (deleteTemplate)="deleteGentemplate($event)"
                    (moveTempUp)="moveUpGentempate($event)" (moveTempDown)="moveDownGentempate($event)"
                    (selectionChanged)="selectGentempate($event)"></app-text-gentemplate>
                  <app-code-gentemplate [outputItem]="outputItem" *ngIf="!outputItem.text  && ((outputItem|dataType)!=='string')"
                    [myIndex]=i [totalResponseTemplateComponentCount]="myObject.keys(templateKeyDict[selectedTemplateKeyInLeftSideBar]).length"
                    [hidden]="activeTab!==myEBotVersionTabs.generation_templates" (deleteTemplate)="deleteGentemplate($event)"
                    (moveTempUp)="moveUpGentempate($event)" (moveTempDown)="moveDownGentempate($event)"
                    (selectionChanged)="selectGentempate($event)"></app-code-gentemplate>
                </div>
              </ng-container>
            </div>
          </div>
          <!--response components list ends-->

          <!--if the value of template key is unparsable, we will show code editor-->
          <ng-container *ngIf="isTemplateKeyOutputUnparsable()">
            <div class="intentItems d-flex-column-last-child-flex-grow-1">
              <div class="d-flex-column-last-child-flex-grow-1 child-expand">
                <app-code-editor class="d-flex-column-last-child-flex-grow-1 child-expand" [text]="{text:getTemplateKeyDictClone()[selectedTemplateKeyInLeftSideBar]}"
                  (textChangedEvent)="updateSelectedTemplateKeyValue($event)"  (validateClick) = "validateCodeTest($event)"></app-code-editor>
              </div>
            </div>
          </ng-container>
          <!--fixed at bottom-->
          <div *ngIf="selectedTemplateKeyOutputIndex.length>0" class="selected-templates d-flex m-2 px-2" style="position: absolute; bottom: 0; left: 0; right: 0; z-index: 200">
            <div>{{selectedTemplateKeyOutputIndex.length}} response selected</div>
            <div class="ml-auto color-primary cursor-pointer" (click)="selectedListCopyModel(IntentSelectionModal)"><i
                class="fa f0c5 fa-upload">
              </i> Copy to
            </div>
            <div class="color-primary ml-2 cursor-pointer" (click)="selectedListDuplicate()"><i class="fa fa-copy ">
              </i>
              Duplicate
            </div>
            <div class="ml-auto color-danger cursor-pointer" (click)="selectedListDelete()">Delete</div>
          </div>
          <!--fixed at bottom-->

        </div>

        <div class="genTempGridItem bot-templates position-relative disabled" [ngClass]="{'cursor-pointer-event-none':!selectedTemplateKeyInLeftSideBar, 'disabled':!selectedTemplateKeyInLeftSideBar}">
          <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; max-height: 100%; overflow-y: auto; overflow-x: hidden">

            <div class="text-center mb-2 bot-template-heading">
              <div class="text-bold">Bot Response Template</div>
              <div class="text-lite">Click on elements to add to response</div>
            </div>
            <ul *ngIf="!isTemplateKeyOutputUnparsable(); else templateKeyIsUnparsableMessage">

              <li class="pl-2 bot-template cursor-pointer" (click)="addTextUnit();">
                <i class="fa fa-align-left"></i>Text
              </li>
              <li class="pl-2 bot-template cursor-pointer">
                <i class=" fa fa-image"></i>Image corousel
              </li>
              <li class="pl-2 bot-template cursor-pointer">
                <i class="fa fa-users"></i>Text Corousel
              </li>
              <li class="pl-2 bot-template cursor-pointer">
                <i class="fa fa-users"></i>Quick Reply
              </li>
              <li class="pl-2 bot-template cursor-pointer" (click)="addCodeUnit();">
                <i class="fa fa-code"></i>Code Input
              </li>
            </ul>

            <ng-template #templateKeyIsUnparsableMessage>
              <div class="text-center" style="font-size: 11px; color: #9e9e9e; position: absolute; top: 50%;right: 0; left: 0">Template
                key output is unparsable</div>
            </ng-template>
          </div>
        </div>
      </div>
      <!--generation template UI ends-->

      <!--<app-code-editor [hidden]="activeTab!==myEBotVersionTabs.generation_templates || showGenTempUi" [text]="{'text' : intents | json}"-->
      <!--(textChangedEvent)="saveText($event)"></app-code-editor>-->

      <!--<app-code-editor [hidden]="activeTab!==myEBotVersionTabs.generation_templates || showGenTempUi"-->
      <!--[text]="{'text' : intents | json}"-->
      <!--(textChangedEvent)="saveText($event)"></app-code-editor>-->
      <app-code-editor *ngIf="activeTab===myEBotVersionTabs.generation_templates && showGenTempEditorAndHideGenTempUi"
        [text]="editorCodeObj[myEBotVersionTabs.generation_templates]" (textChangedEvent)="saveText($event)"  (validateClick) = "validateCodeTest($event)">
      </app-code-editor>

      <app-code-editor [hidden]="activeTab!==myEBotVersionTabs.workflow " [text]="editorCodeObj[myEBotVersionTabs.workflow]"
        (textChangedEvent)="saveText($event)"  (validateClick) = "validateCodeTest($event)"></app-code-editor>
    </div>
    <div class="validation-bar">
      <div class="dot-indicator">
        <i class="fa fa-check-circle color-primary" *ngIf="!selectedVersion.validation[activeTab].error"></i>
        <i class="fa fa-exclamation-triangle color-danger" *ngIf="!!selectedVersion.validation[activeTab].error"></i>

      </div>
      <div class="validation-toggle cursor-pointer" (click)="validationMessageToggle = !validationMessageToggle">
        <i class="fa fa-arrow-circle-right" *ngIf='validationMessageToggle'></i>
        <i class="fa fa-arrow-circle-left" *ngIf='!validationMessageToggle'></i>
      </div>
    </div>
    <div class="validation-message" *ngIf="validationMessageToggle">
      <div class="validation-message-heading" *ngIf="!!selectedVersion.validation[activeTab].error">
        Issues found
      </div>
      <div class="validation-message-heading" *ngIf="!selectedVersion.validation[activeTab].error">
        No issues found
      </div>
      <div class="validation-message-data my-1" *ngIf="!!selectedVersion.validation[activeTab].error">
        error_line = {{ selectedVersion.validation[activeTab].error_line}} <br>
        error_msg = {{ selectedVersion.validation[activeTab].error_msg}} <br>
      </div>
      <div class="validation-message-data my-1" *ngIf="!selectedVersion.validation[activeTab].error">
        Validation was successfull. You can validated again if you need.
      </div>
      <!-- <div class="validation-message-data my-1">
          Validations was successfull.You can validate again if you need.
        </div>
      <div class="validation-message-data my-1">
          Validations was successfull.You can validate again if you need.
        </div> -->
    </div>
  </div>

</div>

<!--fork new version modal starts-->
<ng-template #Primarytemplate>
  <div class="primary-modal">
    <div class="top-dec"></div>
    <div class="modal-header" style="display: block!important;">
      <div class="d-flex">
        <h4 class="modal-title mb-2"> Fork to a new version</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <p>By default it will be saved and not be made active. You need to update changes to make it active.</p>

    </div>

    <div class="modal-body">
      <form class="row" #fork_new_version_form="ngForm">

        <div class="col-md-3 d-flex justify-content-end">
          <label for="">Fork from</label>
        </div>
        <div class="col-md-9 px-0 d-flex justify-content-start">
          <!--<input type="password" [(ngModel)]="forked_From" name="old_password">-->
          <!--<select class="concept1" [(ngModel)]="forked_version_number" required type="number" name="version_id" #select>-->
          <!--<option type="button" *ngFor="let version of bot.store_bot_versions">-->
          <!--<button>{{version.version}}</button>-->
          <!--</option>-->
          <!--</select>-->

          <!--<div class="form-group m-0 mr-4 ml-auto">-->
          <select class="concept1" [(ngModel)]="forked_version_number" required type="number" name="version_id" #select>
            <img style="height: 20px; width: 20px; position: absolute;left: 5px" src="https://s3-eu-west-1.amazonaws.com/imibot-dev/integrations/facebook.png"
              alt="">
            <option type="button" *ngFor="let version of bot.store_bot_versions">
              <button>{{version.version}}</button>
            </option>
          </select>
          <!--</div>-->

        </div>
        <div class="col-md-3 my-2">
          <label for="">Comments on the new version</label>
        </div>
        <div class="col-md-9 px-0 d-flex justify-content-start my-2">
          <textarea type="text" style="width: 100%" [(ngModel)]="forked_comments" name="comment"></textarea>
        </div>
        <div class="col-md-12">
          <p *ngIf="errorMessage" class="text-danger">{{errorMessage}}</p>
          <button class="btn btn-theme-primary-outline mr-1" (click)="modalRef.hide()">Cancel</button>

          <button class="btn btn-theme-primary" (click)="forkNewVersion()">
            Fork
          </button>
        </div>

      </form>
    </div>
  </div>
</ng-template>

<ng-template #IntentModal>
  <div class="primary-modal">
    <div class="top-dec"></div>
    <!--<div class="modal-header">-->
    <!--<h4 class="modal-title" style="display: flex;justify-content: start;">Create new template key</h4>-->
    <!--<button aria-label="Close" class="close pull-right" type="button" (click)="modalRef.hide()"><span-->
    <!--aria-hidden="true">×</span>-->
    <!--</button>-->
    <!--</div>-->
    <div class="modal-body" style="text-align: left">
      <div class="text-bold">Create new template key</div>
      <div class="d-flex align-items-center flex-wrap mt-2">
        <input class="input-material" style="width: 100%" placeholder="Enter template key name" type="text"
          (keyup.enter)="createNewTemplatekey()" [(ngModel)]="newTemplateKey">
        <p *ngIf="templateKeyCreationError" class="text-danger">{{templateKeyCreationError}}</p>
        <div class="d-flex justify-content-end w-100 mt-2">
          <button class="btn btn-theme-primary-outline mr-1" (click)="modalRef.hide()">Cancel</button>
          <button class="btn btn-theme-primary" [disabled]="!newTemplateKey" (click)="createNewTemplatekey();">Create</button>
        </div>
      </div>
    </div>

  </div>
</ng-template>

<ng-template #IntentSelectionModal>
  <div class="primary-modal">
    <div class="top-dec"></div>
    <div class="modal-header" style="border: none !important;">
      <h4 class="modal-title" style="display: flex;justify-content: start;">Copy response templates to</h4>
      <button aria-label="Close" class="close pull-right" type="button" (click)="modalRef.hide()"><span aria-hidden="true">×</span>
      </button>
      <br>
    </div>
    <div class="d-flex w-100 col-12" style="align-items: center;padding-left: 27px;">
      <div>{{(modelGenTempNameForm.value|numberOfTrueKeys)||"No"}} response selected</div>
      <div class="cursor-pointer color-primary ml-3" (click)="modelGenTempNameForm.reset()">
        Clear
      </div>
      <div class="cursor-pointer color-primary ml-auto mr-3" (click)="selectAllCheckBoxesInCopyTemplateForm(modelGenTempNameForm)">
        Select all
      </div>
      <div>
        <input type="text" style="width: 120px;border: 1px solid #e0e0e0;margin-right: 60px; padding: 3px" [(ngModel)]="copyModalTemplateSearchKeyword">
      </div>
    </div>
    <div class="modal-body" style="padding-top: 10px!important;">
      <div class="d-flex flex-column align-items-center justify-content-center m-2" id="checkboxes">

        <form class="modelGridGenTempNames" id="modelGenTempNameForm" #modelGenTempNameForm="ngForm" (submit)="selectedListCopy(modelGenTempNameForm)">
          <label class="container-chekbox text-dark" *ngFor="let templateKey of myObject.keys(templateKeyDict)|filterTemplateLeyList:copyModalTemplateSearchKeyword">{{templateKey}}
            <input type="checkbox" ngModel name="{{templateKey}}">
            <span class="checkmark"></span>
          </label>
        </form>
        <div class="d-flex w-100">
          <button class="btn btn-theme-primary-outline ml-auto mr-2" (click)="modalRef.hide()">Cancel</button>
          <button class="btn btn-theme-primary  d-inline-block mr-2" [disabled]="(modelGenTempNameForm.value|numberOfTrueKeys)<1"
            form="modelGenTempNameForm">Copy
            now
          </button>
        </div>
      </div>
    </div>
  </div>
</ng-template>


<ng-template #deleteTemplateKeyModal>
  <div class="danger-modal">
    <div class="top-dec"></div>
    <div class="modal-header">
      <h4 class="modal-title mb-2" style="display: flex;justify-content: start;">Delete Template key?</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <div class="modal-body pt-0" style="padding:10px !important;">
      <form #form="ngForm">
        <div class="text-center my-1">
          <p class="mb-3">Do you confirm the Deletion? This is a permanent and irreversible change</p>

        </div>
        <div class="d-flex justify-content-end">
          <button class="btn btn-theme-secondary-outline mr-2" (click)="modalRef.hide()">Cancel</button>
          <button class=" btn btn-theme-danger" (click)="deleteTemplateKey(templateKeyToBeDeleted.value)">Delete</button>
        </div>
      </form>
    </div>
  </div>
</ng-template>
<!--<ng-template >-->
<!--<div class="danger-modal">-->
<!--<div class="top-dec"></div>-->
<!--<div class="modal-header">-->
<!--<h4 class="modal-title mb-2" style="display: flex;justify-content: start;">Edit Template key?</h4>-->
<!--<button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">-->
<!--<span aria-hidden="true">&times;</span>-->
<!--</button>-->
<!--</div>-->

<!--<div class="modal-body pt-0">-->
<!--<form #templateKeyEditForm="ngForm">-->
<!--<div class="text-center my-1">-->
<!--&lt;!&ndash;<p class="mb-3">Do you confirm the Deletion? This is a permanent and irreversible change</p>&ndash;&gt;-->
<!--<input ngModel name="old_key" hidden type="text" [ngModel]="templateKeyToBeDeleted.value">-->
<!--<input ngModel name="new_key"type="text">-->
<!--</div>-->
<!--<button class="btn btn-theme-primary" (click)="editTemplateKey(templateKeyEditForm)">Submit</button>-->
<!--</form>-->
<!--</div>-->
<!--</div>-->
<!--</ng-template>-->

<input type="text" hidden #templateKeyToBeDeleted>

<ng-template #EditTemplateKeyModal>
  <div class="primary-modal">
    <div class="top-dec"></div>
    <div class="modal-body" style="text-align: left">
      <div class="text-bold">Edit Template key</div>
      <form #templateKeyEditForm="ngForm" class="d-flex align-items-center flex-wrap mt-2">
        <!--<input class="input-material" style="width: 100%" placeholder="Enter template key name" type="text"-->
        <!--[(ngModel)]="newTemplateKey">-->
        <input ngModel name="old_key" hidden type="text" [ngModel]="templateKeyToBeDeleted.value">
        <input ngModel name="new_key" style="width: 100%" required type="text" [ngModel]="templateKeyToBeDeleted.value"
          (keyup.enter)="editTemplateKey(templateKeyEditForm)">
        <!--<p *ngIf="templateKeyCreationError" class="text-danger">{{templateKeyCreationError}}</p>-->
        <div class="d-flex justify-content-end w-100 mt-2">
          <button class="btn btn-theme-primary-outline mr-1" (click)="modalRef.hide()">Cancel</button>
          <button class="btn btn-theme-primary" [disabled]="!templateKeyEditForm.valid" (click)="editTemplateKey(templateKeyEditForm)">Create</button>
        </div>
      </form>
    </div>

  </div>
</ng-template>