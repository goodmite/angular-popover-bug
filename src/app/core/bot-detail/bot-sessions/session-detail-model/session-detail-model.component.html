<section class="session-modal-section">
  <div class="session-modal-section__header">
    <!-- <div class="session-modal-section__header--action">
      <i class="fa fa-angle-left"
         [ngClass]="{invisible:indexOfCurrentRowSelected<=0 && pageNumberOfCurrentRowSelected<=1}"
         (click)="selectPrevRow.emit()"></i>
      <i class="fa fa-angle-right"
         (click)="selectNextRow.emit()"></i>
    </div> -->

<!-- <<<<<<< HEAD -->
<div class="session-modal-section__header--item">
    <div class="secondary">Room ID:</div>
    <div class="primary16 ">{{_session.id}}</div>
</div>
<div class="session-modal-section__header--item">
    <div class="secondary">Consumer ID:</div>
    <div class="primary16 ">{{_session.consumer_id}}</div>
</div>
<div class="session-modal-section__header--item">
    <span class="secondary">Total Messages</span>
    <span class="primary16">{{sessionMessageData?.length}}</span>
  </div>
<div class="session-modal-section__header--item">
    <div class="secondary">Last updated at</div>
    <div class="primary">{{_session.updated_at | date:"MMM d"}}&nbsp;'{{_session.updated_at | date:"yy"}}&nbsp;{{_session.updated_at | date:"shortTime"}}</div>
</div>
    <!-- <div class="session-modal-section__header--time"> -->
      <!-- <i class="fa fa-refresh" [ngClass]="{'fa-spin':showSpinIcon}"
         (click)="updateModal(_session.id);"></i> -->
      <!-- <div class="last-updated"> -->
<!-- ======= -->
    <!-- <div class="d-flex  align-items-center justify-content-center"> -->
      <!-- <i class="fa fa-refresh mr-2 cursor-pointer" [ngClass]="{'fa-spin':showSpinIcon}" -->
         <!-- (click)="updateModal(_session.id);"></i> -->
      <!-- <div class="d-flex  flex-column align-items-start align-content-start"> -->
<!-- >>>>>>> sprint-11 -->
        <!-- <span class="secondary">Last updated at</span> -->
        <!-- <span class="primary">{{_session.updated_at|date:'mediumDate'}}</span> -->
      <!-- </div> -->
    <!-- </div> -->

    

    <!-- <div class="session-modal-section__header--agent">
      <span class="secondary">Sent to agent</span>
      <span class="primary16">false</span>
    </div> -->

    <!-- <div class="session-modal-section__header--last">
      <div class="room">
        <div class="secondary  font-weight-bold">Room ID:</div>
        <div class="secondary ">{{_session.id}}</div>
      </div>
      
      <div class="consumer">
        <div class="secondary font-weight-bold">Consumer ID:</div>
        <div class="secondary">{{_session.consumer_id}}</div>
      </div>
    </div> -->
    <div (click)="closeModel$.emit()" class ="ml-auto"><i class="fa fa-times cursor-pointer"></i></div>
  </div>
    <div class="session-modal-section__body ">

        <div class="session-modal-section__body--convo">
            <!--search input starts-->
            <mat-form-field class="ml-3">
                <input matInput 
                [ngModel]="messageSearchKeyword"
                (ngModelChange)="scrollToFirstKeywordMatch($event)"
                (keyup.enter)="goToNextSearchResult(messageSearchKeyword)"
                (keyup.shift.enter)="goToPreviousSearchResult(messageSearchKeyword)"
                id="search-session-model" type="search"
                placeholder="search">
                <mat-icon matSuffix style="color : #9e9e9e; font-size: 16px;">search</mat-icon>
              </mat-form-field>
            <!-- <div class="search-theme-input-with-search">
                <input [ngModel]="messageSearchKeyword"
                       (ngModelChange)="scrollToFirstKeywordMatch($event)"
                       (keyup.enter)="goToNextSearchResult(messageSearchKeyword)"
                       (keyup.shift.enter)="goToPreviousSearchResult(messageSearchKeyword)"
                       id="search-session-model" type="search"
                       placeholder="search">
                <i class="fa fa-search"></i>
            </div> -->
            <!--search input ends-->
            <div class="session-messages-container row m-0 my-2 p-1 align-items-start align-content-start">
                <i class="fa fa-angle-down" *ngIf="sessionMessageDataCopy && sessionMessageDataCopy.length > 5"
                   (click)="scrollMessageListToEnd()"></i>
                <div style="height: 100%;width: 100%; padding-right: 5px" class="session-messages-container-list">
                    <div class="col-12 px-0 border-hover-txn"
                         style="padding-left: 5px !important;"
                         *ngFor="let txnConversationItems of sessionMessageDataCopy|serializeSessionMessage|highlightSessionTexts:messageSearchKeyword; let i=index"
                         [ngClass]="{'border-selected-txn':txnConversationItems.transaction_id === transactionIdSelectedInModel,
'border-unselected-txn':txnConversationItems.transaction_id !== transactionIdSelectedInModel}">
                        <!--<app-chat-feedback></app-chat-feedback>-->
                        <app-session-message [txnConversationItems]="txnConversationItems"
                                             (messageClickedEvent$)="transactionIdChangedInModel($event)"></app-session-message>
                    </div>
                </div>
                <div *ngIf="!sessionMessageDataCopy || sessionMessageData.length===0"
                     style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; "
                     class="col-12 align-self-stretch d-flex justify-content-center align-items-center">
                    <p class="text-muted">No Messages to show</p>
                </div>
            </div>
        </div>

        <div class="session-modal-section__body--metadata ">
            <!--todo: get back to this code after removing bootstrap-->
            <ul class="nav nav-tabs my-2 pb-0">
                <!--TODO: *ngIf="bot.child_bots && bot.child_bots.length>0" below-->
                <li class="nav-item px-0">
                    <a class="nav-link p-0 mr-2" [ngClass]="{'tab-active':activeTab==='manager_bot'}"
                       (click)="tabClicked('manager_bot')"><strong>TRANSACTION INFO</strong></a>
                </li>
                <li class="nav-item mr-2">
                    <a class="nav-link p-0" [ngClass]="{'tab-active':activeTab==='active_bot'}"
                       (click)="tabClicked('active_bot')" *ngIf="bot.is_manager"><strong>ACTIVE BOT</strong></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link p-0" [ngClass]="{'tab-active':activeTab==='nlp'}"
                       (click)="tabClicked('nlp')"><strong>NLP</strong></a>
                </li>
                <li class="nav-item ml-auto">
                    <a class="nav-link p-0 mr-2" [ngClass]="{'tab-active':activeTab==='final_df'}"
                       (click)="tabClicked('final_df')"><strong>FINAL DF</strong></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link p-0 mr-2" [ngClass]="{'tab-active':activeTab==='datastore'}"
                       (click)="tabClicked('datastore')"><strong>DATASTORE</strong></a>
                </li>
            </ul>
            <div *ngIf="!codeText" class="editor-container"
                 style="width: 100%; height: 100%;">
                <i class="fa fa-arrow-left" style="font-size: 15px; color: #9e9e9e"></i>
                <i style="color: #9e9e9e;">Select a transaction to
                    see metadata associated</i>
            </div>
            <app-code-editor *ngIf="codeText" class="child-expand" [text]="{ text: codeText|json}"></app-code-editor>
        </div>
        <!--</div>-->
    </div>
</section>