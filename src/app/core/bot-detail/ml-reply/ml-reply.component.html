<header>
  <div class="d-flex flex-row heading">
    <strong class="heading-title">
      Replies
    </strong>
    <div class="article-state " *ngIf="mlResponse && mlResponse.state as state"
         [ngStyle]="{'background-color':  (mlResponse.state === 'saved' || mlResponse.state ===  'cloned') ? '#fdc31c':
          state === 'training' ? '#f48a42' :
          state === 'trained' ? '#00abd3' :
          state === 'live' ? '#34bc6e' : '#00abd3', 'color': (state === 'saved' || mlResponse.state ===  'cloned') ? '#474747' : '#ffffff' }">
      {{ (state === 'saved' || mlResponse.state ===  'cloned')? 'Saved' :
        state === 'training' ? 'Training' :
            state === 'trained' ? 'Trained' :
                state === 'live' ? 'Live' : 'Trained' }}
    </div>
    <div class="mr-auto">
    </div>
    <div style="display: flex" *ngIf="mlResponse.state !== 'live'">
      <button (click)="makeLive()"
              style="padding: 0 10px 0 8px !important;"
              class="btn-theme btn-theme-primary mat-theme-button mr-1">
        <mat-icon class="mat-icon material-icons">arrow_upward</mat-icon>
        Make live
      </button>

      <app-button-wrapper
        class="card--update"
        [icon]="'edit'"
        [isMatFlatButton]="false"
        [text]="'Discard draft'"
        (btnClick)="loadFromLive()">
      </app-button-wrapper>
    </div>
  </div>
  <div style="color: #696969;font-size: 11px;">
    Configure the responses for the recognized intents and entities to complete user flow
  </div>
</header>

<div style="position: relative; min-height: 80vh">
  <app-imi-loader class="loader-center" *ngIf="showLoading"></app-imi-loader>
  <app-button-wrapper
    style="position: absolute;
    right: 0;
    top: 23px;
    z-index: 10;"
    class="card--update"
    [icon]="'refresh'"
    [isMatFlatButton]="false"
    [text]="'Update'"
    (btnClick)="updateResponse()">
  </app-button-wrapper>

  <mat-tab-group (selectedTabChange)="tabChanged($event)" *ngIf="!showLoading">
    <mat-tab label="Templates">
      <app-code-gentemplate-ui-wrapper
        style="flex-grow: 1; min-height: 60vh"
        class="row mx-0 px-0 child-expand ml-bot-reply"
        [bot]="bot"
        [templateKeyDict]="templateKeyDict"
        [headingAsSelectedTemplateKey]="true"
        [hideChannelDropdown]="true"
        [showModeSelect]="true"
        [response]="mlResponse"
        (modeChanged$)="log($event)"
        [defaultTemplateKeys]="mlResponse?.default_templates"
        [channelList]="[]"
      >
      </app-code-gentemplate-ui-wrapper>
    </mat-tab>
    <mat-tab label="Workflows" class="no-over-flow h-100">
      <app-code-editor
        style="height: 500px"
        class="code-editor"
        [text]="workFlowObj"
        [doShowValidationsIcon]="false"
        [doShowUploadDownloadButton]="false"
      ></app-code-editor>
    </mat-tab>
  </mat-tab-group>
</div>

