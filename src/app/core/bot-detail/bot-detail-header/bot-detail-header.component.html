
<div class="row-bot-detail-header d-flex align-items-center my-1">
  <img style="width: 32px;height: 32px" class="rounded-circle" [src]="bot.logo" alt="">
  <div class="name">
    <div class="heading mb-0">{{bot.name}}</div>
  </div>
  <i class="fa fa-users" *ngIf="bot && bot.is_manager" style="font-size: 16px"></i>
  <div class="d-flex align-items-center">
    <i class="fa fa-circle dark-green"></i>
    <div>Active(v{{bot.active_version.version}})</div>
  </div>
  <div class="text-theme-normal mr-3 d-none d-md-block">
    <span class="text-muted">Created by :</span>{{bot.created_by}} <span class="text-muted">on</span>{{bot.created_at|date}}
  </div>
  <div class="text-theme-normal d-none d-lg-block">
    <span class="text-muted">Last Updated By :</span>{{bot.updated_by}} <span class="text-muted">on</span>{{bot.updated_at|date}}
  </div>
  <div class="ml-auto"></div>

  <span *myIf="myEAllActions['Get Integrations']">
    <img *ngFor="let integrationsMasterListItem of ((bot.integrations|integrationLogos:'only_channel'|async))"
         [src]="integrationsMasterListItem?.icon"
         class="logo-image " style="width: 16px;height: 16px" alt="">
    <img id="id" *ngFor="let integrationsMasterListItem of ((bot.integrations|integrationLogos:'no_channel'|async))"
         [src]="integrationsMasterListItem?.icon" class="logo-image " style="width: 16px;height: 16px" alt="">
  </span>
  <span *ngIf="myObject.keys(bot.integrations).length>4" class="more">
    +{{myObject.keys(bot.integrations).length-4}} More
  </span>
  <div class="headerDivider mx-2"></div>
  <div *myIf="myEAllActions['Send API']">
    <div class="d-flex preview-box align-items-center" (click)="openBot()" *ngIf="bot.bot_type === 'chatbot'">
      <i class="fa fa-comment-o cursor-pointer" style="font-size: 15px"></i>
      <span class="action">Preview</span>
    </div>
  </div>

  <div *myIf="myEAllActions['Update Bots']" class="d-flex preview-box align-items-center"
       (click)="refreshBotDetails()">
    <i class="fa fa-refresh cursor-pointer" style="font-size: 15px" [ngClass]="{'fa-spin':showSpinIcon}"></i>
    <span class="action">Cancel</span>
    <!---->
  </div>
  <button mat-flat-button color="primary" class="btn-theme text-white" (click)="openActiveBotChangedModal(activeVersionChangedTemplate)"
          *myIf="myEAllActions['Update Bots']">Update Bot
  </button>
  <button mat-icon-button [matMenuTriggerFor]="appMenu" class="click-save-wrapper">
    <mat-icon>more_vert</mat-icon>
  </button>
  <mat-menu class="cutom-md-menu" #appMenu="matMenu">
    <button mat-menu-item (click)="utilityService.copyToClipboard(bot.bot_access_token)"><i class="fa fa-copy mr-1"></i>Copy Access Token</button>
    <button mat-menu-item (click)="utilityService.copyToClipboard(bot.enterprise_id)"><i class="fa fa-copy mr-1"></i>Copy Enterprise ID</button>
    <button mat-menu-item *myIf="[myEAllActions['Get Pipeline Module'],myEAllActions['Get Integrations'],myEAllActions['Get Bot Knowledge base']]" (click)="openDeleteModal()"><i class="fa fa-trash mr-1"></i>Delete</button>
  </mat-menu>
</div>


<ng-template #template>
  <div class="danger-modal center-modal">
    <div class="top-dec"></div>
    <div class="modal-header">
      <h4 class="modal-title mb-2" style="display: flex;justify-content: start;">Delete bot&nbsp;{{ bot.name}}&nbsp;
        ?</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <div class="modal-body pt-0">
      <form #form="ngForm">
        <div class="text-center my-1">
          <p class="mb-3">This action cannot be undone.Are you sure you wish to delete?</p>

        </div>
        <button class="btn-theme btn-theme-secondary-outline mr-2" (click)="modalRef.hide()">Cancel</button>
        <button class=" btn-theme btn-theme-danger" (click)="deleteBot()">Delete</button>
      </form>
    </div>
  </div>
</ng-template>


<ng-template #activeVersionChangedTemplate>
  <div class="danger-modal">
    <div class="top-dec"></div>
    <div class="modal-header">
      <h4 class="modal-title mb-2" style="display: flex;justify-content: start;">Active version changed</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <div class="modal-body pt-0">
      <form #form="ngForm">
        <div class="text-center my-1">
          <p class="mb-3">If you update the bot your currently selected version will be the new Active version.</p>

        </div>
        <button class="btn-theme btn-theme-secondary-outline mr-2" (click)="modalRef.hide()">Cancel</button>
        <button class=" btn-theme btn-theme-danger" (click)="updateBot()">Update</button>
      </form>
    </div>
  </div>
</ng-template>

